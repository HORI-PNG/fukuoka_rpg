body {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: sans-serif;
    background-color: #0c1445; /* 夜空の色 */
    color: white;
}

/* パズル画像のパスを指定 */
:root {
    --puzzle-image: url('./キャナルシティ博多.png');
    --puzzle-width: 450px; /* 150px * 3 */
    --puzzle-height: 270px; /* 90px * 3 */
    --piece-width: 150px; /* (450 / 3) */
    --piece-height: 90px; /* (270 / 3) */
}

#puzzle-board {
    width: var(--puzzle-width);
    height: var(--puzzle-height);
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    border: 2px solid #fff;
}

.puzzle-slot {
    width: var(--piece-width);
    height: var(--piece-height);
    background-color: #333;
    border: 1px dashed #777;
    box-sizing: border-box;
    position: relative; /* ★追加： スナップしたピースの基準 */
}

#piece-container {
    margin-top: 20px;
    width: calc(var(--puzzle-width) + 20px);
    height: calc(var(--piece-height) * 3 + 20px); /* 3段積める高さ */
    padding: 10px;
    background-color: #222;
    border-radius: 5px;
    position: relative; /* ★変更： ピースの初期位置の基準 */
}

.puzzle-piece {
    width: var(--piece-width);
    height: var(--piece-height);
    background-image: var(--puzzle-image);
    background-size: var(--puzzle-width) var(--puzzle-height);
    border: 2px solid #ccc;
    cursor: grab;
    box-sizing: border-box;
    
    position: absolute; /* ★変更： 常に絶対配置 */
    transition: transform 0.1s ease-out, box-shadow 0.2s; /* 動きを滑らかに */
    z-index: 10; /* 通常は手前 */
}

/* ★追加： タッチ操作中のピースのスタイル */
.puzzle-piece.dragging {
    transform: scale(1.1); /* 少し大きく */
    box-shadow: 0 5px 15px rgba(0,0,0,0.3); /* 影をつける */
    z-index: 100; /* 最も手前に表示 */
    cursor: grabbing;
}

/* ★追加： スロットにはまったピース */
.puzzle-piece.snapped {
    border: none;
    cursor: default;
    z-index: 1; /* スロットの奥に */
    position: absolute; /* スロットの(0,0)基準 */
    left: 0;
    top: 0;
}

/* ピースごとの背景位置 (3x3) */
.piece-0 { background-position: 0 0; }
.piece-1 { background-position: -150px 0; }
.piece-2 { background-position: -300px 0; }
.piece-3 { background-position: 0 -90px; }
.piece-4 { background-position: -150px -90px; }
.piece-5 { background-position: -300px -90px; }
.piece-6 { background-position: 0 -180px; }
.piece-7 { background-position: -150px -180px; }
.piece-8 { background-position: -300px -180px; }

/* 結果表示 */
.result-area {
    margin-top: 20px;
    padding: 20px;
    text-align: center;
    background-color: white;
    color: black;
    border-radius: 10px;
}
#back-to-map {
    padding: 10px 20px;
    font-size: 1em;
    cursor: pointer;
}